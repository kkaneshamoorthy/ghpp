{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Our Menu</title>

    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/scrolling-nav.css' %}" />
    <link rel="stylesheet" href="{% static 'css/main.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/hover-min.css' %}">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <script type="text/javascript" src="resources/js/script.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

</head>

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll" href="{{ index }}">Galley Hill Peri Peri</a>
            </div>

            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    <li class="hidden">
                        <a class="page-scroll" href="{{ index }}"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#contact">Menu</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#about">About Us</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#contact">Contact Us</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#contact"> My Order <span class="glyphicon glyphicon-shopping-cart"/> </a>
                    </li>
                </ul>

                <form class="navbar-form navbar-right" role="search">
                  <div class="form-group">
                    <input type="text" class="form-control" placeholder="Search">
                  </div>
                  <button type="submit" class="btn btn-default">Search</button>
                </form>
            </div>
        </div>
    </nav>

    <section id="menu" class="intro-section">
 <div class="container">
        <div class="row">
            <div id="menuBar" class="col-lg-3">
                <ul class="nav nav-pills navbar-flow nav-stacked navbar-left">
{#                      <li role="presentation" class="active"><a href="#alochol">Alochol</a></li>#}
                    {% for category in category_list %}
                        <li role="presentation"><a href="#{{ category.sub_name }}"> {{ category.name }} </a></li>
                    {% endfor %}
                    </ul>
            </div>

            <div id="menu_list" class="col-lg-9">

             <script>
             var output = "";
                {% for category in category_list %}
                    {% for product in product %}
                        {% if product.category == category.name %}
                                  $(document).ready( function() {
                                    var request = new XMLHttpRequest();
                                    request.onreadystatechange = function() {
                                      if (this.readyState == 4) {
                                          var data = JSON.parse(request.response);
                                          output = "<h1 id='{{ category.sub_name }}'> {{ category.name }} </h1>";
                                          output += "<h5> {{ category.description }} </h5>";
                                          output += "<div class='panel panel-default' style='background-color: transparent'>";
                                          output += "<div class='panel-body' align='left'>";

                                          for (var i=0; i < data.length; i++) {
                                              var p = data[i];
                                              console.log(p.id);
                                              output += "<strong>" + p["name"] + "</strong> <br>";
                                              output += p["description"] + "<br>";
                                              output += "<table class='table'> <tr>";

                                              //display different size and their prices
                                              var portion = p["size"].split(";");
                                              for (var j=0; j<portion.length; j++) {
                                                  var sizeData = portion[j].split(":");

                                                  output += "<td>" + sizeData[0 ] + "</td>";
                                                  output += "<td>Â£"+ sizeData[1];

                                                  output+="<a id='btn-add-basket' value='productID="+p.id+":portion="+sizeData[0]+":price="+sizeData[1]+"' class='hvr-grow'> <span class='glyphicon glyphicon-plus-sign' aria-hidden='true'></span> </a> </td> </tr>";
                                              }

                                              output+="</table>";
                                          }
                                          output += "</div>"

                                          var panel = document.getElementById("menu_list");
                                          panel.innerHTML = panel.innerHTML + output;
                                      }
                                    };
                                    request.open("GET", "/product/{{ product.category }}/", true);
                                    request.send();
                                  });


                        {% endif %}
                    {% endfor %}
                {% endfor %}
            </script>
            </div>
        </div>
    </div>
    </section>

  <!-- jQuery -->
{#    <script src="{% static '/js/jquery.js' %} "></script>#}
    <script src="{% static '/js/jquery-3.1.1.min.js' %} "></script>
    <script src="{% static '/js/jquery-ui.min.js' %} "></script>

    <!-- Bootstrap Core JavaScript -->
    <script src={% static 'js/bootstrap.min.js' %}></script>

    <!-- Scrolling Nav JavaScript -->
{#    <script src="resources/js/jquery.easing.min.js"></script>#}
    <script src="{% static 'js/scrolling-nav.js' %}"></script>
    <script src="{% static 'js/slippry.min.js' %}"></script>



    <script>
        $("a").click(function () {
                 console.log("ADDED");
{#                 var quantity = $('#quantity').find(":selected").text();#}
{#                 var id = {{ product_id }};#}
{#                 $.ajax({#}
{#                     url: "/api/addproduct/",#}
{#                     type: 'POST',#}
{#                     data: {'id': id, 'quantity': quantity},#}
{#                     success: function (result) {#}
{#                         location.reload();#}
{#                     }#}
{#                 });#}
             });
    </script>


</body>

</html>